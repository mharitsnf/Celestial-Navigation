[gd_scene load_steps=35 format=3 uid="uid://b6c54usfla1jt"]

[ext_resource type="PackedScene" uid="uid://bohsb8opfjfgr" path="res://assets/levels/world_test.tscn" id="1_n8kch"]
[ext_resource type="Script" path="res://assets/prefabs/UI/manager/ui_manager.gd" id="3_1ye6f"]
[ext_resource type="Shader" path="res://assets/resources/shaders/kuwahara/kuwahara_1.gdshader" id="3_fdjca"]
[ext_resource type="PackedScene" uid="uid://v5c54hsyvq5g" path="res://assets/prefabs/UI/camera_mask/camera_mask.tscn" id="3_yisfc"]
[ext_resource type="Shader" path="res://assets/resources/shaders/mask.gdshader" id="4_bhpxt"]
[ext_resource type="PackedScene" uid="uid://d11f84wu226j8" path="res://assets/prefabs/save_system/save_system.tscn" id="4_bncqj"]
[ext_resource type="PackedScene" uid="uid://c0s7a0klmw3ek" path="res://assets/prefabs/UI/screens/TransitionScreen.tscn" id="4_e6h3r"]
[ext_resource type="Shader" path="res://assets/resources/shaders/kuwahara/kuwahara_2.gdshader" id="4_jtngu"]
[ext_resource type="Shader" path="res://assets/resources/shaders/gaussian_blur/gaussian_blur_1.gdshader" id="4_tfxoa"]
[ext_resource type="Texture2D" uid="uid://esccb0ghemjn" path="res://assets/resources/textures/camera_mask.PNG" id="5_7v5rb"]
[ext_resource type="Shader" path="res://assets/resources/shaders/kuwahara/kuwahara_3.gdshader" id="5_hx2ft"]
[ext_resource type="PackedScene" uid="uid://duaihjbmtuquu" path="res://assets/prefabs/UI/hud/time_hud.tscn" id="5_mtnxj"]
[ext_resource type="Shader" path="res://assets/resources/shaders/gaussian_blur/gaussian_blur_2.gdshader" id="5_vyf2m"]
[ext_resource type="Shader" path="res://assets/resources/shaders/kuwahara/kuwahara_4.gdshader" id="6_s5m2l"]
[ext_resource type="Material" uid="uid://dq86rwx1owyye" path="res://assets/resources/materials/m_grain_pp.tres" id="7_b30w6"]
[ext_resource type="Texture2D" uid="uid://de1lsimp3xj4n" path="res://assets/resources/textures/sextant_mask.png" id="8_gkf3r"]

[sub_resource type="ViewportTexture" id="ViewportTexture_wow5l"]
viewport_path = NodePath("Main/SubViewport")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_34fqm"]
resource_local_to_scene = true
shader = ExtResource("3_fdjca")
shader_parameter/channel_0 = SubResource("ViewportTexture_wow5l")

[sub_resource type="ViewportTexture" id="ViewportTexture_o3v1u"]
viewport_path = NodePath("Main/SubViewport")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_o4l0g"]
resource_local_to_scene = true
shader = ExtResource("4_tfxoa")
shader_parameter/main_tex = SubResource("ViewportTexture_o3v1u")

[sub_resource type="ViewportTexture" id="ViewportTexture_03n60"]
viewport_path = NodePath("BlurX/SubViewport")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_7d7kl"]
resource_local_to_scene = true
shader = ExtResource("5_vyf2m")
shader_parameter/main_tex = SubResource("ViewportTexture_03n60")

[sub_resource type="ViewportTexture" id="ViewportTexture_1wrdw"]
viewport_path = NodePath("BlurY/SubViewport")

[sub_resource type="ViewportTexture" id="ViewportTexture_bkwbr"]
viewport_path = NodePath("KWH1/SubViewport")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_2utn7"]
resource_local_to_scene = true
shader = ExtResource("4_jtngu")
shader_parameter/blur_amount = 16
shader_parameter/blur_iterations = 16
shader_parameter/blur_quality = 4
shader_parameter/blrd_tex = SubResource("ViewportTexture_1wrdw")
shader_parameter/channel_0 = SubResource("ViewportTexture_bkwbr")

[sub_resource type="ViewportTexture" id="ViewportTexture_sg41y"]
viewport_path = NodePath("Main/SubViewport")

[sub_resource type="ViewportTexture" id="ViewportTexture_a2sf3"]
viewport_path = NodePath("KWH1/SubViewport")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_xu1to"]
resource_local_to_scene = true
shader = ExtResource("5_hx2ft")
shader_parameter/kuwahara_level = 0.0
shader_parameter/radius = 6.0
shader_parameter/q = 12.0
shader_parameter/alpha = 5.0
shader_parameter/channel_0 = SubResource("ViewportTexture_sg41y")
shader_parameter/channel_1 = SubResource("ViewportTexture_a2sf3")

[sub_resource type="ViewportTexture" id="ViewportTexture_4kpq6"]
viewport_path = NodePath("KWH2/SubViewport")

[sub_resource type="ViewportTexture" id="ViewportTexture_x7eh1"]
viewport_path = NodePath("KWH3/SubViewport")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_k56qo"]
resource_local_to_scene = true
shader = ExtResource("6_s5m2l")
shader_parameter/sigma = 1.5
shader_parameter/channel_0 = SubResource("ViewportTexture_4kpq6")
shader_parameter/channel_1 = SubResource("ViewportTexture_x7eh1")

[sub_resource type="FastNoiseLite" id="FastNoiseLite_b28bo"]
noise_type = 2
frequency = 0.0228
fractal_octaves = 2
fractal_lacunarity = 1.95
fractal_gain = 0.865
fractal_weighted_strength = 0.66
cellular_jitter = 1.88
domain_warp_enabled = true
domain_warp_fractal_gain = 0.88

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_g7ims"]
noise = SubResource("FastNoiseLite_b28bo")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_slcvo"]
resource_local_to_scene = true
shader = ExtResource("4_bhpxt")
shader_parameter/cutoff = 0.0
shader_parameter/smooth_size = 0.0
shader_parameter/camera_mask_tex = ExtResource("5_7v5rb")
shader_parameter/sextant_mask_tex = ExtResource("8_gkf3r")
shader_parameter/transition_noise_tex = SubResource("NoiseTexture2D_g7ims")

[node name="Root" type="Node"]

[node name="SaveSystem" parent="." instance=ExtResource("4_bncqj")]

[node name="Main" type="SubViewportContainer" parent="."]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="SubViewport" type="SubViewport" parent="Main"]
handle_input_locally = false
msaa_3d = 2
screen_space_aa = 1
scaling_3d_mode = 1
scaling_3d_scale = 0.55
positional_shadow_atlas_16_bits = false
size = Vector2i(1280, 720)
render_target_update_mode = 4

[node name="WorldTest" parent="Main/SubViewport" instance=ExtResource("1_n8kch")]

[node name="KWH1" type="SubViewportContainer" parent="."]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="SubViewport" type="SubViewport" parent="KWH1"]
handle_input_locally = false
size = Vector2i(1280, 720)
render_target_update_mode = 4

[node name="ColorRect" type="ColorRect" parent="KWH1/SubViewport"]
material = SubResource("ShaderMaterial_34fqm")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="BlurX" type="SubViewportContainer" parent="."]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="SubViewport" type="SubViewport" parent="BlurX"]
handle_input_locally = false
size = Vector2i(1280, 720)
render_target_update_mode = 4

[node name="ColorRect" type="ColorRect" parent="BlurX/SubViewport"]
material = SubResource("ShaderMaterial_o4l0g")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="BlurY" type="SubViewportContainer" parent="."]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="SubViewport" type="SubViewport" parent="BlurY"]
handle_input_locally = false
size = Vector2i(1280, 720)
render_target_update_mode = 4

[node name="ColorRect" type="ColorRect" parent="BlurY/SubViewport"]
material = SubResource("ShaderMaterial_7d7kl")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="KWH2" type="SubViewportContainer" parent="."]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="SubViewport" type="SubViewport" parent="KWH2"]
handle_input_locally = false
size = Vector2i(1280, 720)
render_target_update_mode = 4

[node name="ColorRect" type="ColorRect" parent="KWH2/SubViewport"]
material = SubResource("ShaderMaterial_2utn7")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="KWH3" type="SubViewportContainer" parent="."]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="SubViewport" type="SubViewport" parent="KWH3"]
handle_input_locally = false
size = Vector2i(1280, 720)
render_target_update_mode = 4

[node name="ColorRect" type="ColorRect" parent="KWH3/SubViewport"]
material = SubResource("ShaderMaterial_xu1to")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="KWH4" type="SubViewportContainer" parent="."]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="SubViewport" type="SubViewport" parent="KWH4" groups=["final_viewport"]]
handle_input_locally = false
size = Vector2i(1280, 720)
render_target_update_mode = 4

[node name="ColorRect" type="ColorRect" parent="KWH4/SubViewport"]
material = SubResource("ShaderMaterial_k56qo")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="Control" type="Control" parent="KWH4/SubViewport"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="TimeHUD" parent="KWH4/SubViewport/Control" instance=ExtResource("5_mtnxj")]
layout_mode = 0
anchors_preset = 0
anchor_top = 0.0
anchor_bottom = 0.0
offset_left = 0.0
offset_top = 0.0
offset_right = 264.0
offset_bottom = 78.0
grow_vertical = 1

[node name="CameraMask2" parent="KWH4/SubViewport/Control" instance=ExtResource("3_yisfc")]
material = SubResource("ShaderMaterial_slcvo")
layout_mode = 1
offset_left = 0.0
offset_top = 0.0
offset_right = 0.0
offset_bottom = 0.0

[node name="UIManager" type="CanvasLayer" parent="KWH4/SubViewport" groups=["ui_manager"]]
layer = 4
script = ExtResource("3_1ye6f")

[node name="Grain" type="SubViewportContainer" parent="."]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="SubViewport" type="SubViewport" parent="Grain" groups=["final_viewport"]]
handle_input_locally = false
size = Vector2i(1280, 720)
render_target_update_mode = 4

[node name="ColorRect" type="ColorRect" parent="Grain/SubViewport"]
material = ExtResource("7_b30w6")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="TransitionCL" type="CanvasLayer" parent="."]
layer = 5

[node name="TransitionScreen" parent="TransitionCL" instance=ExtResource("4_e6h3r")]
